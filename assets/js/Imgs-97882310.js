import{d as z,ak as q,i as w,al as W,G as S,x as F,r as u,o as _,c as y,b as t,w as r,F as X,a as i,Y as U,v as M,ad as C,q as N,h as P,ac as f,p as H,g as K,Z as G,_ as Y,U as x,u as ee,am as le}from"./index-63c25652.js";import{u as A}from"./upload-e5aca4eb.js";import{_ as J}from"./_plugin-vue_export-helper-c27b6911.js";const Z=c=>(H("data-v-0965da18"),c=c(),K(),c),ae={class:"upload-box"},te=["src"],se=Z(()=>i("span",null,"编辑",-1)),oe=Z(()=>i("span",null,"查看",-1)),ie=Z(()=>i("span",null,"删除",-1)),ne={key:1,class:"upload-empty"},de={class:"el-upload__tip"},ue=z({name:"UploadImg"}),ce=z({...ue,props:{imageUrl:{default:""},api:{},drag:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},fileSize:{default:5},fileType:{default:()=>["image/jpeg","image/png","image/gif"]},height:{default:"150px"},width:{default:"150px"},borderRadius:{default:"8px"}},emits:["update:imageUrl"],setup(c,{emit:E}){q(l=>({dc9ef9b8:l.width,eade30ee:l.height,"4c64fe80":l.borderRadius}));const s=c,m=w("id-"+W()),g=w(!1),p=S(G,void 0),n=S(Y,void 0),h=F(()=>s.disabled||(p==null?void 0:p.disabled)),$=E,k=async l=>{let o=new FormData;o.append("file",l.file);try{const e=s.api??A,{data:a}=await e(o);$("update:imageUrl",a.fileUrl),n!=null&&n.prop&&(p==null||p.validateField([n.prop]))}catch(e){l.onError(e)}},T=()=>{$("update:imageUrl","")},D=()=>{const l=document.querySelector(`#${m.value} .el-upload__input`);l&&l.dispatchEvent(new MouseEvent("click"))},B=l=>{const o=l.size/1024/1024<s.fileSize,e=s.fileType.includes(l.type);return e||f({title:"温馨提示",message:"上传图片不符合所需的格式！",type:"warning"}),o||setTimeout(()=>{f({title:"温馨提示",message:`上传图片大小不能超过 ${s.fileSize}M！`,type:"warning"})},0),e&&o},L=()=>{f({title:"温馨提示",message:"图片上传成功！",type:"success"})},I=()=>{f({title:"温馨提示",message:"图片上传失败，请您重新上传！",type:"error"})};return(l,o)=>{const e=u("Edit"),a=u("el-icon"),d=u("ZoomIn"),b=u("Delete"),V=u("Plus"),j=u("el-upload"),R=u("el-image-viewer");return _(),y("div",ae,[t(j,{id:m.value,action:"#",class:N(["upload",h.value?"disabled":"",l.drag?"no-border":""]),multiple:!1,disabled:h.value,"show-file-list":!1,"http-request":k,"before-upload":B,"on-success":L,"on-error":I,drag:l.drag,accept:l.fileType.join(",")},{default:r(()=>[l.imageUrl?(_(),y(X,{key:0},[i("img",{src:l.imageUrl,class:"upload-image"},null,8,te),i("div",{class:"upload-handle",onClick:o[1]||(o[1]=M(()=>{},["stop"]))},[h.value?U("",!0):(_(),y("div",{key:0,class:"handle-icon",onClick:D},[t(a,null,{default:r(()=>[t(e)]),_:1}),se])),i("div",{class:"handle-icon",onClick:o[0]||(o[0]=v=>g.value=!0)},[t(a,null,{default:r(()=>[t(d)]),_:1}),oe]),h.value?U("",!0):(_(),y("div",{key:1,class:"handle-icon",onClick:T},[t(a,null,{default:r(()=>[t(b)]),_:1}),ie]))])],64)):(_(),y("div",ne,[C(l.$slots,"empty",{},()=>[t(a,null,{default:r(()=>[t(V)]),_:1})],!0)]))]),_:3},8,["id","class","disabled","drag","accept"]),i("div",de,[C(l.$slots,"tip",{},void 0,!0)]),g.value?(_(),P(R,{key:0,"url-list":[l.imageUrl],onClose:o[2]||(o[2]=v=>g.value=!1)},null,8,["url-list"])):U("",!0)])}}});const ke=J(ce,[["__scopeId","data-v-0965da18"]]),O=c=>(H("data-v-97a8fa44"),c=c(),K(),c),pe={class:"upload-box"},re={class:"upload-empty"},me=["src"],_e=["onClick"],fe=O(()=>i("span",null,"查看",-1)),ge=["onClick"],ve=O(()=>i("span",null,"删除",-1)),ye={class:"el-upload__tip"},he=z({name:"UploadImgs"}),be=z({...he,props:{fileList:{default:()=>[]},api:{},drag:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},limit:{default:5},fileSize:{default:5},fileType:{default:()=>["image/jpeg","image/png","image/gif"]},height:{default:"150px"},width:{default:"150px"},borderRadius:{default:"8px"}},emits:["update:fileList"],setup(c,{emit:E}){q(e=>({"0858da64":e.borderRadius,f6d20c00:e.width,"170d67a6":e.height}));const s=c,m=S(G,void 0),g=S(Y,void 0),p=F(()=>s.disabled||(m==null?void 0:m.disabled)),n=w(s.fileList);x(()=>s.fileList,e=>{n.value=e});const h=e=>{const a=e.size/1024/1024<s.fileSize,d=s.fileType.includes(e.type);return d||f({title:"温馨提示",message:"上传图片不符合所需的格式！",type:"warning"}),a||setTimeout(()=>{f({title:"温馨提示",message:`上传图片大小不能超过 ${s.fileSize}M！`,type:"warning"})},0),d&&a},$=async e=>{let a=new FormData;a.append("file",e.file);try{const d=s.api??A,{data:b}=await d(a);e.onSuccess(b)}catch(d){e.onError(d)}},k=E,T=(e,a)=>{e&&(a.url=e.fileUrl,k("update:fileList",n.value),g!=null&&g.prop&&(m==null||m.validateField([g.prop])),f({title:"温馨提示",message:"图片上传成功！",type:"success"}))},D=e=>{n.value=n.value.filter(a=>a.url!==e.url||a.name!==e.name),k("update:fileList",n.value)},B=()=>{f({title:"温馨提示",message:"图片上传失败，请您重新上传！",type:"error"})},L=()=>{f({title:"温馨提示",message:`当前最多只能上传 ${s.limit} 张图片，请移除后上传！`,type:"warning"})},I=w(""),l=w(!1),o=e=>{I.value=e.url,l.value=!0};return(e,a)=>{const d=u("el-icon"),b=u("ZoomIn"),V=u("Delete"),j=u("el-upload"),R=u("el-image-viewer");return _(),y("div",pe,[t(j,{"file-list":n.value,"onUpdate:fileList":a[1]||(a[1]=v=>n.value=v),action:"#","list-type":"picture-card",class:N(["upload",p.value?"disabled":"",e.drag?"no-border":""]),multiple:!0,disabled:p.value,limit:e.limit,"http-request":$,"before-upload":h,"on-exceed":L,"on-success":T,"on-error":B,drag:e.drag,accept:e.fileType.join(",")},{file:r(({file:v})=>[i("img",{src:v.url,class:"upload-image"},null,8,me),i("div",{class:"upload-handle",onClick:a[0]||(a[0]=M(()=>{},["stop"]))},[i("div",{class:"handle-icon",onClick:Q=>o(v)},[t(d,null,{default:r(()=>[t(b)]),_:1}),fe],8,_e),p.value?U("",!0):(_(),y("div",{key:0,class:"handle-icon",onClick:Q=>D(v)},[t(d,null,{default:r(()=>[t(V)]),_:1}),ve],8,ge))])]),default:r(()=>[i("div",re,[C(e.$slots,"empty",{},()=>[t(d,null,{default:r(()=>[t(ee(le))]),_:1})],!0)])]),_:3},8,["file-list","class","disabled","limit","drag","accept"]),i("div",ye,[C(e.$slots,"tip",{},void 0,!0)]),l.value?(_(),P(R,{key:0,"url-list":[I.value],onClose:a[2]||(a[2]=v=>l.value=!1)},null,8,["url-list"])):U("",!0)])}}});const Ie=J(be,[["__scopeId","data-v-97a8fa44"]]);export{Ie as U,ke as a};
